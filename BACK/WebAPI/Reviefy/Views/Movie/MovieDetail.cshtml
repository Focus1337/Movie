@model ViewModel

@{
    ViewBag.Title = Model.MovieById.Title  + " - Movies";
    Layout = "_Master";
}

<body>

    <!-- =============== START OF WRAPPER =============== -->
    <div class="wrapper">
    
        <!-- =============== START OF MOVIE DETAIL INTRO =============== -->
        <section class="movie-detail-intro overlay-gradient ptb100"
            style="background: url(@Model.MoviePhotoById.Background)">
        </section>
        <!-- =============== END OF MOVIE DETAIL INTRO =============== -->
    

        <!-- =============== START OF MOVIE DETAIL INTRO 2 =============== -->
        <section class="movie-detail-intro2">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">

                        <div class="movie-poster">
                            <img src="@Model.MovieById.PosterPath"
                                alt="" width="300">
                        </div>

                        <div class="movie-details">
                            <h3 class="title">@Model.MovieById.Title</h3>

                            <ul class="movie-subtext">
                                <li>@Model.MovieById.Duration min</li>
                                <li>@Model.MovieById.Genre</li>
                                <li>@Model.MovieById.ReleaseDate.ToString("d") (@Model.MovieById.Country)</li>
                            </ul>

                            <a href="@Model.MovieById.TrailerPath"
                                class="btn btn-main btn-effect">trailer</a>

                            <div class="rating mt10">
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star-o"></i>
                                <span>@Model.MovieById.Rating / 10</span>
                            </div>
                        </div>

                        <div class="clearfix"></div>

                    </div>
                </div>
            </div>
        </section>
        <!-- =============== End OF MOVIE DETAIL INTRO 2 =============== -->


        <!-- =============== START OF MOVIE DETAIL MAIN SECTION =============== -->
        <section class="movie-detail-main ptb100">
            <div class="container">

                <div class="row">
                    <!-- Start of Movie Main -->
                    <div class="col-lg-8 col-sm-12">
                        <div class="inner pr50">

                            <!-- Storyline -->
                            <div class="storyline">
                                <h3 class="title">Storyline</h3>

                                <p>@Model.MovieById.Storyline</p>
                            </div>

                            <!-- Media -->
                            <div class="movie-media mt50">
                                <h3 class="title"> Photos & Videos</h3>

                                <ul class="image-gallery isotope">
                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo1">
                                            <img src="@Model.MoviePhotoById.Photo1" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo2">
                                            <img src="@Model.MoviePhotoById.Photo2" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo3">
                                            <img src="@Model.MoviePhotoById.Photo3" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo4">
                                            <img src="@Model.MoviePhotoById.Photo4" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo5">
                                            <img src="@Model.MoviePhotoById.Photo5" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo6">
                                            <img src="@Model.MoviePhotoById.Photo6" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo7">
                                            <img src="@Model.MoviePhotoById.Photo7" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo8">
                                            <img src="@Model.MoviePhotoById.Photo8" class="img-responsive" alt="">
                                        </a>
                                    </li>

                                    <li class="element">
                                        <a href="@Model.MoviePhotoById.Photo9">
                                            <img src="@Model.MoviePhotoById.Photo9" class="img-responsive" alt="">
                                        </a>
                                    </li>
                                </ul>

                            </div>

                        </div>
                    </div>
                    <!-- End of Movie Main -->


                    <!-- Start of Sidebar -->
                    <div class="col-lg-4 col-sm-12">
                        <div class="sidebar">

                            <!-- Start of Details Widget -->
                            <aside class="widget widget-movie-details">
                                <h3 class="title">Details</h3>

                                <ul>
                                    <li><strong>Release date: </strong>@Model.MovieById.ReleaseDate.ToString("d")</li>
                                    <li><strong>Director: </strong>@Model.MovieById.Director</li>
                                    <li><strong>Budget: </strong>@Model.MovieById.Budget million USD</li>
                                    <li><strong>Country: </strong>@Model.MovieById.Country</li>
                                    <li><strong>Language: </strong>@Model.MovieById.Language</li>
                                    <li><strong>Production Co: </strong>@Model.MovieById.Company</li>
                                </ul>
                            </aside>
                            <!-- End of Details Widget -->

                        </div>
                    </div>
                    <!-- End of Sidebar -->
                </div>

            </div>
        </section>
        <!-- =============== END OF MOVIE DETAIL MAIN SECTION =============== -->


        <!-- =============== START OF REVIEWS SECTION =============== -->
        <section class="recommended-movies bg-light ptb100">
            <div class="container">

                <!-- Start of Reviews -->
                <div class="comments">
                    <h3 class="title">Reviews (@Model.Reviews.Count)</h3>

                    <ul class="list-unstyled mt30">

                        @foreach(var review in Model.Reviews)
                        {
                            <li class="media">
                                <div class="review-box">
                                    <img class="img-circle" src="@Model.Users.FirstOrDefault(x => x.UserId == review.UserId)?.AvatarPath" alt="">
                                    
                                    <div class="review-box-fix">
                                       
                                        <a asp-controller="User" asp-action="UserProfile" asp-route-id="@review.UserId">
                                            <h4>@Model.Users.FirstOrDefault(x => x.UserId == review.UserId)?.Nickname</h4>
                                        </a>
                                        <div class="review-box-rating">
                                            <i class="fa fa-star"></i>
                                            <span>@review.Rating/10</span>
                                        </div>

                                        <div class="review-box-date">
                                            <div class="bloglist-meta">
                                                <i class="fa fa-calendar"></i> @review.ReviewDate.ToString("d")
                                            </div>
                                        </div>

                                        <hr>
                                        <p>@Html.Raw(review.Text)</p>
                                        <hr>

                                        <div class="review-box-helpfulness">
                                            Review helpfulness:
                                            <a asp-controller="Review" asp-action="IncreaseHelpfulness"
                                               asp-route-id="@review.ReviewId" class="btn">
                                                <i class="fa fa-arrow-up"></i>
                                            </a>
                                            <span>@review.Helpfulness</span>
                                            <a asp-controller="Review" asp-action="DecreaseHelpfulness"
                                               asp-route-id="@review.ReviewId" class="btn">
                                                <i class="fa fa-arrow-down"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        }
                    </ul>

                </div>
                <!-- End of Reviews -->

                <hr class="op-5 mtb50">

                <!-- Start of Review Form -->
                <div class="comment-form">
                    <h3 class="mt-0 mb-1">Add Review</h3>
                    <h3></h3>

                    @if (Context.Session.Keys.Contains("user"))
                    {
                    <form class="row mt30" asp-controller="Review" asp-action="WriteReview" method="post">
                            <div class="form-group col-md-6" style="padding-right: 35%;">
                                <label class="subtitle">Rating</label>
                                <select name="rating" required>
                                    <option value="">Choose rating</option>
                                    <option value="1">1 -> Terrible</option>
                                    <option value="2">2 -> Bad</option>
                                    <option value="3">3 -> Bad</option>
                                    <option value="4">4 -> OK</option>
                                    <option value="5">5 -> OK</option>
                                    <option value="6">6 -> Good</option>
                                    <option value="7">7 -> Good</option>
                                    <option value="8">8 -> Great</option>
                                    <option value="9">9 -> Great</option>
                                    <option value="10">10 -> Excellent</option>
                                </select>
                            </div>

                            <div class="form-group col-md-12 m-t-20">
                                <textarea name="text" class="form-control" rows="5"
                                placeholder="Review" required></textarea>
                            </div>

                            <div class="form-group col-md-12 m-t-20">
                                <button type="submit" class="btn btn-main btn-effect">Submit</button>
                            </div>

                            <input name="movieId" type="hidden" value="@Model.MovieById.MovieId">
                    </form>
                    }
                    else
                    {
                        <h6>Oops! You must -
                            <a asp-controller="Auth" asp-action="Login"><b>Log in</b></a> - before leaving review!</h6>
                    }
                </div>
                <!-- End of Review Form -->

            </div>
        </section>
        <!-- =============== END OF REVIEWS SECTION =============== -->
    
    </div>
    <!-- =============== END OF WRAPPER =============== -->


    <!-- ===== Start of Back to Top Button ===== -->
    <div id="backtotop">
        <a href="#"></a>
    </div>
    <!-- ===== End of Back to Top Button ===== -->

</body>